USE fasiclin;

DELIMITER $$

CREATE PROCEDURE SP_CADASTRAR_PESSOA(
    IN P_TIPOPESSOA ENUM('F', 'J'),
    IN P_CPF CHAR(11),
    IN P_NOME VARCHAR(100),
    IN P_DATANASC DATE,
    IN P_SEXO ENUM('M', 'F'),
    IN P_CNPJ CHAR(14),
    IN P_RAZSOCIAL VARCHAR(100),
    IN P_NOMEFAN VARCHAR(100),
    IN P_CNAE CHAR(7),
    IN P_TIPOENDER ENUM('COM', 'RES'),
    IN P_ID_TIPOLOGRA INT,
    IN P_LOGRADOURO VARCHAR(100),
    IN P_NUMEENDER VARCHAR(10),
    IN P_COMPLEMENTO VARCHAR(100),
    IN P_BAIRRO VARCHAR(100),
    IN P_CEP CHAR(8),
    IN P_ID_CIDADE INT,
    IN P_ID_TIPOCONTATO INT,
    IN P_NUMERO VARCHAR(12),
    IN P_EMAIL VARCHAR(100)
)
BEGIN
    DECLARE ID_PESSOA INT;

    INSERT INTO PESSOA (TIPOPESSOA) 
    VALUES (P_TIPOPESSOA);
    
    SET ID_PESSOA = LAST_INSERT_ID();

    IF P_TIPOPESSOA = 'F' THEN
        INSERT INTO PESSOAFIS (ID_PESSOA, CPFPESSOA, NOMEPESSOA, DATANASCPES, SEXOPESSOA) 
        VALUES (ID_PESSOA, P_CPF, P_NOME, P_DATANASC, P_SEXO);
    ELSE
        INSERT INTO PESSOAJUR (ID_PESSOA, CNPJ, RAZSOCIAL, NOMEFAN, CNAE) 
        VALUES (ID_PESSOA, P_CNPJ, P_RAZSOCIAL, P_NOMEFAN, P_CNAE);
    END IF;

    INSERT INTO ENDERECO (TIPOENDER, ID_TIPOLOGRA, LOGRADOURO, NUMEENDER, COMPLEMENTO, BAIRRO, CEP, ID_CIDADE, ID_PESSOA) 
    VALUES (P_TIPOENDER, P_ID_TIPOLOGRA, P_LOGRADOURO, P_NUMEENDER, P_COMPLEMENTO, P_BAIRRO, P_CEP, P_ID_CIDADE, ID_PESSOA);

    INSERT INTO CONTATO (ID_TIPOCONTATO, NUMERO, ID_PESSOA) 
    VALUES (P_ID_TIPOCONTATO, P_NUMERO, ID_PESSOA);

    INSERT INTO EMAIL (EMAIL, ID_PESSOA) 
    VALUES (P_EMAIL, ID_PESSOA);

END$$

DELIMITER ;



INSERT INTO TIPOLOGRADO(TIPO) VALUES ('Rua'), ('Avenida'), ('Travessa');
INSERT INTO TIPOCONTATO(TIPO) VALUES ('Celular'), ('Telefone Fixo'), ('WhatsApp'), ('Comercial'), ('Residencial'), ('Recado');

CALL SP_CADASTRAR_PESSOA('F','98765432100','Maria Oliveira','1985-10-12','F',NULL,NULL,NULL,NULL,'RES',2,'Rua das Acácias','45','Casa','Bela Vista','78120000',2,2,'65987654321','maria.oliveira@email.com');

CALL SP_CADASTRAR_PESSOA('F','45678912300','Carlos Souza','1978-03-22','M',NULL,NULL,NULL,NULL,'COM',1,'Avenida Brasil','500','Sala 101','Centro Sul','78048000',3,1,'65984561234','carlos.souza@email.com');

CALL SP_CADASTRAR_PESSOA('F','32165498700','Ana Paula','1992-07-15','F',NULL,NULL,NULL,NULL,'RES',3,'Rua São João','88','','Vila Nova','78200000',4,3,'65983456789','ana.paula@email.com');

CALL SP_CADASTRAR_PESSOA('F','78912345600','Ricardo Lima','1980-11-30','M',NULL,NULL,NULL,NULL,'RES',2,'Travessa das Palmeiras','12','','Jardim América','78350000',5,2,'65981239876','ricardo.lima@email.com');

CALL SP_CADASTRAR_PESSOA('F','15975348600','Fernanda Costa','1995-02-18','F',NULL,NULL,NULL,NULL,'COM',1,'Rua XV de Novembro','200','Bloco B','Centro','78180000',6,1,'65987651234','fernanda.costa@email.com');

CALL SP_CADASTRAR_PESSOA('F','85274196300','Roberto Martins','1988-09-05','M',NULL,NULL,NULL,NULL,'RES',3,'Rua das Laranjeiras','77','Fundos','Bosque da Saúde','78065000',7,4,'65985472319','roberto.martins@email.com');

CALL SP_CADASTRAR_PESSOA('F','96325874100','Juliana Mendes','1993-06-27','F',NULL,NULL,NULL,NULL,'COM',1,'Alameda dos Anjos','340','','Residencial Park','78260000',8,5,'65983219876','juliana.mendes@email.com');

CALL SP_CADASTRAR_PESSOA('F','74185296300','Eduardo Pires','1982-01-09','M',NULL,NULL,NULL,NULL,'RES',2,'Rua Bela Cintra','1200','Apto 101','Vila Mariana','78130000',9,2,'65986751243','eduardo.pires@email.com');

CALL SP_CADASTRAR_PESSOA('F','25896314700','Patricia Silva','1997-04-14','F',NULL,NULL,NULL,NULL,'RES',1,'Rua Ouro Preto','65','','Nova Esperança','78310000',10,6,'65985674123','patricia.silva@email.com');

CALL SP_CADASTRAR_PESSOA('F','14785236900','Bruno Almeida','1990-12-03','M',NULL,NULL,NULL,NULL,'COM',3,'Avenida das Torres','999','Sala 502','Centro Norte','78070000',11,1,'65982347651','bruno.almeida@email.com');

CALL SP_CADASTRAR_PESSOA('J',NULL,NULL,NULL,NULL,'12345678000199','Empresa Alpha LTDA','Alpha','6201500','COM',1,'Avenida Paulista','1000','Conjunto 1502','Bela Vista','01310000',1,1,'11999998888','contato@alpha.com');

CALL SP_CADASTRAR_PESSOA('J',NULL,NULL,NULL,NULL,'98765432000155','Beta Comércio SA','Beta','4711301','RES',2,'Rua Augusta','500','','Consolação','01305000',2,2,'11988887777','vendas@beta.com');

CALL SP_CADASTRAR_PESSOA('J',NULL,NULL,NULL,NULL,'45678912000166','Gamma Serviços ME','Gamma Serviços','8129901','COM',3,'Rua Frei Caneca','750','Sala 20','Centro','01307000',3,3,'11977776666','suporte@gamma.com');

CALL SP_CADASTRAR_PESSOA('J',NULL,NULL,NULL,NULL,'32165498000144','Delta Tecnologia LTDA','Delta Tech','6204000','RES',1,'Avenida Brasil','12000','Bloco C','Jardim América','01430000',4,4,'11966665555','tech@delta.com');

CALL SP_CADASTRAR_PESSOA('J',NULL,NULL,NULL,NULL,'78912345000111','Epsilon Educacional','Epsilon','8513100','COM',2,'Rua das Palmeiras','890','Sala 305','Bela Vista','01320000',5,5,'11955554444','contato@epsilon.com');

CALL SP_CADASTRAR_PESSOA('J',NULL,NULL,NULL,NULL,'15975348000122','Zeta Construções EIRELI','Zeta','4120400','RES',3,'Rua São João','350','','Centro','01035000',6,6,'11944443333','obras@zeta.com');

CALL SP_CADASTRAR_PESSOA('J',NULL,NULL,NULL,NULL,'85274196000133','Eta Transportes','Eta Transp','4930201','COM',1,'Avenida do Estado','2500','Galpão 2','Mooca','03118000',7,1,'11933332222','logistica@eta.com');

CALL SP_CADASTRAR_PESSOA('J',NULL,NULL,NULL,NULL,'96325874000177','Theta Consultoria','Theta','7020400','RES',2,'Rua Bela Cintra','1500','Sala 504','Consolação','01415000',8,2,'11922221111','consultoria@theta.com');

CALL SP_CADASTRAR_PESSOA('J',NULL,NULL,NULL,NULL,'74185296000100','Iota Soluções Ambientais','Iota Ambiental','3839400','COM',3,'Rua Tabapuã','445','Sala 78','Itaim Bibi','04533010',9,3,'11911110000','sustentavel@iota.com');

CALL SP_CADASTRAR_PESSOA('J',NULL,NULL,NULL,NULL,'25896314000188','Kappa Distribuidora','Kappa Dist','4647101','RES',1,'Avenida Faria Lima','3500','Conjunto 1201','Jardim Paulistano','04538000',10,4,'11900009999','distribuicao@kappa.com');


CALL SP_CADASTRAR_PESSOA(
    'F',                      -- P_TIPOPESSOA
    '12345678901',           -- P_CPF
    'João da Silva',         -- P_NOME
    '1990-05-15',            -- P_DATANASC
    'M',                     -- P_SEXO
    NULL,                    -- P_CNPJ (não utilizado para pessoa física)
    NULL,                    -- P_RAZSOCIAL
    NULL,                    -- P_NOMEFAN
    NULL,                    -- P_CNAE
    'RES',                   -- P_TIPOENDER
    1,                       -- P_ID_TIPOLOGRA (supondo que 1 seja "Rua")
    'Rua das Flores',        -- P_LOGRADOURO
    '123',                   -- P_NUMEENDER
    'Ap 202',                -- P_COMPLEMENTO
    'Jardim Primavera',      -- P_BAIRRO
    '12345678',              -- P_CEP
    10,                      -- P_ID_CIDADE (ex: São Paulo)
    2,                       -- P_ID_TIPOCONTATO (ex: Celular)
    '11999998888',           -- P_NUMERO
    'joao.silva@email.com'   -- P_EMAIL
);


INSERT INTO CONTATO (ID_TIPOCONTATO, NUMERO, ID_PESSOA) VALUES (1, '11987654321', 1);
INSERT INTO CONTATO (ID_TIPOCONTATO, NUMERO, ID_PESSOA) VALUES (2, '21912345678', 2);
INSERT INTO CONTATO (ID_TIPOCONTATO, NUMERO, ID_PESSOA) VALUES (3, '31998765432', 3);
INSERT INTO CONTATO (ID_TIPOCONTATO, NUMERO, ID_PESSOA) VALUES (4, '41987651234', 4);
INSERT INTO CONTATO (ID_TIPOCONTATO, NUMERO, ID_PESSOA) VALUES (5, '51999887766', 5);
INSERT INTO CONTATO (ID_TIPOCONTATO, NUMERO, ID_PESSOA) VALUES (6, '61988776655', 6);
INSERT INTO CONTATO (ID_TIPOCONTATO, NUMERO, ID_PESSOA) VALUES (1, '71977665544', 7);
INSERT INTO CONTATO (ID_TIPOCONTATO, NUMERO, ID_PESSOA) VALUES (2, '81966554433', 8);
INSERT INTO CONTATO (ID_TIPOCONTATO, NUMERO, ID_PESSOA) VALUES (3, '91955443322', 9);
INSERT INTO CONTATO (ID_TIPOCONTATO, NUMERO, ID_PESSOA) VALUES (4, '11944332211', 10);

INSERT INTO ENDERECO (TIPOENDER, ID_TIPOLOGRA, LOGRADOURO, NUMEENDER, COMPLEMENTO, BAIRRO, CEP, ID_CIDADE, ID_PESSOA) VALUES ('COM', 1, 'Rua XV de Novembro', '150', 'Sala 10', 'Centro', '80020010', 1, 1);
INSERT INTO ENDERECO (TIPOENDER, ID_TIPOLOGRA, LOGRADOURO, NUMEENDER, COMPLEMENTO, BAIRRO, CEP, ID_CIDADE, ID_PESSOA) VALUES ('RES', 2, 'Avenida Getúlio Vargas', '2500', '', 'Água Verde', '80240030', 2, 2);
INSERT INTO ENDERECO (TIPOENDER, ID_TIPOLOGRA, LOGRADOURO, NUMEENDER, COMPLEMENTO, BAIRRO, CEP, ID_CIDADE, ID_PESSOA) VALUES ('COM', 3, 'Rua das Acácias', '78', 'Bloco B', 'Jardim Botânico', '80210060', 3, 3);
INSERT INTO ENDERECO (TIPOENDER, ID_TIPOLOGRA, LOGRADOURO, NUMEENDER, COMPLEMENTO, BAIRRO, CEP, ID_CIDADE, ID_PESSOA) VALUES ('RES', 1, 'Alameda Dr. Carlos de Carvalho', '980', 'Apto 1201', 'Batel', '80440000', 4, 4);
INSERT INTO ENDERECO (TIPOENDER, ID_TIPOLOGRA, LOGRADOURO, NUMEENDER, COMPLEMENTO, BAIRRO, CEP, ID_CIDADE, ID_PESSOA) VALUES ('COM', 2, 'Rua Marechal Deodoro', '500', '', 'Centro', '80010000', 5, 5);

INSERT INTO EMAIL (EMAIL, ID_PESSOA) VALUES ('contato1@empresa.com', 1);
INSERT INTO EMAIL (EMAIL, ID_PESSOA) VALUES ('contato2@empresa.com', 2);
INSERT INTO EMAIL (EMAIL, ID_PESSOA) VALUES ('contato3@empresa.com', 3);
INSERT INTO EMAIL (EMAIL, ID_PESSOA) VALUES ('contato4@empresa.com', 4);
INSERT INTO EMAIL (EMAIL, ID_PESSOA) VALUES ('contato5@empresa.com', 5);
INSERT INTO EMAIL (EMAIL, ID_PESSOA) VALUES ('contato6@empresa.com', 6);
INSERT INTO EMAIL (EMAIL, ID_PESSOA) VALUES ('contato7@empresa.com', 7);
INSERT INTO EMAIL (EMAIL, ID_PESSOA) VALUES ('contato8@empresa.com', 8);
INSERT INTO EMAIL (EMAIL, ID_PESSOA) VALUES ('contato9@empresa.com', 9);
INSERT INTO EMAIL (EMAIL, ID_PESSOA) VALUES ('contato10@empresa.com', 10);


SELECT 
	IDPESSOA,
	NOME,
	CPF,
	DATA_NASCIMENTO,
    SEXO,
    LOGRADOURO,
    NUMERO,
    BAIRRO,
    CEP,
    CIDADE,
    ESTADO,
    TIPO_ENDERECO,
    EMAIL, CONTATO,
    TIPO_CONTATO
FROM VW_PESSOAFIS
ORDER BY IDPESSOA DESC
;